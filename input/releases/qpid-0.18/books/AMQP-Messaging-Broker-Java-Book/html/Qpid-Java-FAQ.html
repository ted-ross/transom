<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>1.2.  Qpid Java FAQ</title><link rel="stylesheet" href="css/style.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.73.2"><link rel="start" href="index.html" title="AMQP Messaging Broker (Implemented in Java)"><link rel="up" href="Java-General-User-Guides.html" title="Chapter 1. General User Guides"><link rel="prev" href="Java-General-User-Guides.html" title="Chapter 1. General User Guides"><link rel="next" href="Java-Environment-Variables.html" title="1.3.  Java Environment Variables"></head><body><div class="container" bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><DIV class="header"><DIV class="logo"><H1>Apache Qpid™</H1><H2>Open Source AMQP Messaging</H2></DIV></DIV><DIV class="menu_box"><DIV class="menu_box_top"></DIV><DIV class="menu_box_body"><H3>Apache Qpid</H3><UL><LI><A href="http://qpid.apache.org/index.html">Home</A></LI><LI><A href="http://qpid.apache.org/download.html">Download</A></LI><LI><A href="http://qpid.apache.org/getting_started.html">Getting Started</A></LI><LI><A href="http://www.apache.org/licenses/">License</A></LI><LI><A href="https://cwiki.apache.org/qpid/faq.html">FAQ</A></LI></UL></DIV><DIV class="menu_box_bottom"></DIV><DIV class="menu_box_top"></DIV><DIV class="menu_box_body"><H3>Documentation</H3><UL><LI><A href="http://qpid.apache.org/documentation.html#doc-release">Latest Release</A></LI><LI><A href="http://qpid.apache.org/documentation.html#doc-trunk">Trunk</A></LI><LI><A href="http://qpid.apache.org/documentation.html#doc-archives">Archive</A></LI></UL></DIV><DIV class="menu_box_bottom"></DIV><DIV class="menu_box_top"></DIV><DIV class="menu_box_body"><H3>Community</H3><UL><LI><A href="http://qpid.apache.org/getting_involved.html">Getting Involved</A></LI><LI><A href="http://qpid.apache.org/source_repository.html">Source Repository</A></LI><LI><A href="http://qpid.apache.org/mailing_lists.html">Mailing Lists</A></LI><LI><A href="https://cwiki.apache.org/qpid/">Wiki</A></LI><LI><A href="https://issues.apache.org/jira/browse/qpid">Issue Reporting</A></LI><LI><A href="http://qpid.apache.org/people.html">People</A></LI><LI><A href="http://qpid.apache.org/acknowledgements.html">Acknowledgements</A></LI></UL></DIV><DIV class="menu_box_bottom"></DIV><DIV class="menu_box_top"></DIV><DIV class="menu_box_body"><H3>Developers</H3><UL><LI><A href="https://cwiki.apache.org/qpid/building.html">Building Qpid</A></LI><LI><A href="https://cwiki.apache.org/qpid/developer-pages.html">Developer Pages</A></LI></UL></DIV><DIV class="menu_box_bottom"></DIV><DIV class="menu_box_top"></DIV><DIV class="menu_box_body"><H3>About AMQP</H3><UL><LI><A href="http://qpid.apache.org/amqp.html">What is AMQP?</A></LI></UL></DIV><DIV class="menu_box_bottom"></DIV><DIV class="menu_box_top"></DIV><DIV class="menu_box_body"><H3>About Apache</H3><UL><LI><A href="http://www.apache.org">Home</A></LI><LI><A href="http://www.apache.org/foundation/sponsorship.html">Sponsorship</A></LI><LI><A href="http://www.apache.org/foundation/thanks.html">Thanks</A></LI><LI><A href="http://www.apache.org/security/">Security</A></LI></UL></DIV><DIV class="menu_box_bottom"></DIV></DIV><div class="main_text_area"><div class="main_text_area_top"></div><div class="main_text_area_body"><DIV class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">AMQP Messaging Broker (Implemented in Java)</a></span> &gt; <span class="breadcrumb-link"><a href="Java-General-User-Guides.html">General User Guides</a></span> &gt; <span class="breadcrumb-node">
      Qpid Java FAQ
    </span></DIV><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="Qpid-Java-FAQ"></a>1.2. 
      Qpid Java FAQ
    </h2></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="QpidJavaFAQ-Purpose"></a>1.2.1. Purpose</h3></div></div></div><p>
            Here are a list of commonly asked questions and answers. Click on
            the the bolded questions for the answer to unfold. If you have
            any questions which are not on this list, please email our
            qpid-user list.
          </p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="QpidJavaFAQ-WhatisQpid-3F"></a>1.2.1.1. 
            What is Qpid ?
          </h4></div></div></div><p>
            The java implementation of Qpid is a pure Java message broker
            that implements the AMQP protocol. Essentially, Qpid is a robust,
            performant middleware component that can handle your messaging
            traffic.
          </p><p>
            It currently supports the following features:
          </p><div class="itemizedlist"><ul><li><p>High performance header-based routing for messages
            </p></li><li><p>All features required by the JMS 1.1 specification. Qpid
            passes all tests in the Sun JMS compliance test suite
            </p></li><li><p>Transaction support
            </p></li><li><p>Persistence using the high performance Berkeley DB Java
            Edition. The persistence layer is also pluggable should an
            alternative implementation be required. The BDB store is
            available from the <a class="xref" href="">???</a> page
            </p></li><li><p>Pluggable security using SASL. Any Java SASL provider can be
            used
            </p></li><li><p>Management using JMX and a custom management console built
            using Eclipse RCP
            </p></li><li><p>Naturally, interoperability with other clients including the
            Qpid .NET, Python, Ruby and C++ implementations
            </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="QpidJavaFAQ-WhyamIgettingaConfigurationExceptionatbrokerstartup-3F"></a>1.2.1.2. 
            Why am I getting a ConfigurationException at broker startup ?
          </h4></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="QpidJavaFAQ-InvocationTargetException"></a>
            InvocationTargetException
          </h5></div></div></div><p>
            If you get a java.lang.reflect.InvocationTargetException on
            startup, wrapped as ConfigurationException like this:
          </p><pre class="programlisting">
Error configuring message broker: org.apache.commons.configuration.ConfigurationException: java.lang.reflect.InvocationTargetException 
2008-09-26 15:14:56,529 ERROR [main] server.Main (Main.java:206) - Error configuring message broker: org.apache.commons.configuration.ConfigurationException: java.lang.reflect.InvocationTargetException 
org.apache.commons.configuration.ConfigurationException: java.lang.reflect.InvocationTargetException 
at org.apache.qpid.server.security.auth.database.ConfigurationFilePrincipalDatabaseManager.initialisePrincipalDatabase(ConfigurationFilePrincipalDatabaseManager.java:158) 
at org.apache.qpid.server.security.auth.database.ConfigurationFilePrincipalDatabaseManager.initialisePrincipalDatabases(ConfigurationFilePrincipalDatabaseManager.java:87) 
at org.apache.qpid.server.security.auth.database.ConfigurationFilePrincipalDatabaseManager.&lt;init&gt;(ConfigurationFilePrincipalDatabaseManager.java:56) 
at org.apache.qpid.server.registry.ConfigurationFileApplicationRegistry.initialise(ConfigurationFileApplicationRegistry.java:117) 
at org.apache.qpid.server.registry.ApplicationRegistry.initialise(ApplicationRegistry.java:79) 
at org.apache.qpid.server.registry.ApplicationRegistry.initialise(ApplicationRegistry.java:67) 
at org.apache.qpid.server.Main.startup(Main.java:260) 
at org.apache.qpid.server.Main.execute(Main.java:196) 
at org.apache.qpid.server.Main.&lt;init&gt;(Main.java:96) 
at org.apache.qpid.server.Main.main(Main.java:454) 
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) 
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) 
at java.lang.reflect.Method.invoke(Method.java:597) 
at com.intellij.rt.execution.application.AppMain.main(AppMain.java:90) 
Caused by: java.lang.reflect.InvocationTargetException 
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) 
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) 
at java.lang.reflect.Method.invoke(Method.java:597) 
at org.apache.qpid.server.security.auth.database.ConfigurationFilePrincipalDatabaseManager.initialisePrincipalDatabase(ConfigurationFilePrincipalDatabaseManager.java:148) 
</pre><p>
            .. then it means you have a missing password file.
          </p><p>
            You need to create a password file for your deployment and update
            your config.xml to reflect the location of the password file for
            your instance.
          </p><p>
            The config.xml can be a little confusing in terms of element
            names and file names for passwords.
          </p><p>
            To do this, you need to edit the passwordDir element for the
            broker, which may have a comment to that effect:
          </p><pre class="programlisting">
&lt;passwordDir&gt;&lt;!-- Change to the location --&gt;&lt;/passwordDir&gt;
</pre><p>
            The file should be named passwd by default but if you want to you
            can change this by editing this element:
          </p><pre class="programlisting">
&lt;value&gt;${passwordDir}/passwd&lt;/value&gt;
</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="QpidJavaFAQ-Cannotlocateconfigurationsourcenull-2Fvirtualhosts.xml"></a>
            Cannot locate configuration source null/virtualhosts.xml
          </h5></div></div></div><p>
            If you get this message, wrapped inside a ConfigurationException
            then you've come across a known issue, see JIRA <a class="xref" href="">???</a>
          </p><p>
            The work around is to use a qualified path as the parameter value
            for your -c option, rather than (as you migth be) starting the
            broker from your installed etc directory. Even going up one level
            and using a path relative to your Â£QPID_HOME directory
            would sort this e.g qpid-server -c ./etc/myconfig.xml
          </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="QpidJavaFAQ-HowdoIruntheQpidbroker-3F"></a>1.2.1.3. 
            How do I run
            the Qpid broker ?
          </h4></div></div></div><p>
            The broker comes with a script for unix/linux/cygwin called
            qpid-server, which can be found in the bin directory of the
            installed package. This command can be executed without any
            paramters and will then use the default configuration file
            provided on install.
          </p><p>
            For the Windows OS, please use qpid-server.bat.
          </p><p>
            There's no need to set your classpath for QPID as the scripts
            take care of that by adding jar's with classpath defining
            manifest files to your classpath.
          </p><p>
            For more information on running the broker please see our
            <a class="xref" href="">???</a> page.
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="QpidJavaFAQ-HowcanIcreateaconnectionusingaURL-3F"></a>1.2.1.4. 
            How can I
            create a connection using a URL ?
          </h4></div></div></div><p>
            Please see the <a class="xref" href="">???</a> documentation.
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="QpidJavaFAQ-HowdoIrepresentaJMSDestinationstringwithQPID-3F"></a>1.2.1.5. 
            How
            do I represent a JMS Destination string with QPID ?
          </h4></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="QpidJavaFAQ-Queues"></a>
            Queues
          </h5></div></div></div><p>
            A queue can be created in QPID using the following URL format.
          </p><p>
            direct://amq.direct/&lt;Destination&gt;/&lt;Queue
            Name&gt;
          </p><p>
            For example:
            direct://amq.direct/&lt;Destination&gt;/simpleQueue
          </p><p>
            Queue names may consist of any mixture of digits, letters, and
            underscores.
          </p><p>
            The <a class="xref" href="">???</a> is described in more
            detail on it's own page.
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="QpidJavaFAQ-Topics"></a>
            Topics
          </h5></div></div></div><p>
            A topic can be created in QPID using the following URL format.
          </p><p>
            topic://amq.topic/&lt;Topic Subscription&gt;/
          </p><p>
            The topic subscription may only contain the letters A-Z and a-z
            and digits 0-9.
          </p><p>
            The topic subscription is formed from a series of words that may
            only contain the letters A-Z and a-z and digits 0-9.
            The words are delimited by dots. Each dot represents a new level.
          </p><p>
            For example: stocks.nyse.ibm
          </p><p>
            Wildcards can be used on subscription with the following meaning.
          </p><div class="itemizedlist"><ul><li><p>match a single level
              # match zero or more levels
            </p></li></ul></div><p>
            For example:
            With two clients
            1 - stocks.*.ibm
            2 - stocks.#.ibm
          </p><p>
            Publishing stocks.nyse.ibm will be received by both
            clients but stocks.ibm and stocks.world.us.ibm
            will only be received by client 2.
          </p><p>
            The topic currently does not support wild cards.
          </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="QpidJavaFAQ-HowdoIconnecttothebrokerusingJNDI-3F"></a>1.2.1.6. 
            How do I
            connect to the broker using JNDI ?
          </h4></div></div></div><p>
            see <a class="xref" href="">???</a>
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="QpidJavaFAQ-I-27musingSpringandWeblogiccanyouhelpmewiththeconfigurationformovingovertoQpid-3F"></a>1.2.1.7. 
            I'm using Spring and Weblogic - can you help me with the
            configuration for moving over to Qpid ?
          </h4></div></div></div><p>
            Here is a donated Spring configuration file <a class="ulink" href="http://qpid.apache.org/qpid-java-faq.data/appContext.zip" target="_top">appContext.zip</a>
            which shows the config for Qpid side by side with
            Weblogic. HtH !
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="QpidJavaFAQ-HowdoIconfigurethelogginglevelforQpid-3F"></a>1.2.1.8. 
            How do
            I configure the logging level for Qpid ?
          </h4></div></div></div><p>
            The system property
          </p><pre class="programlisting">
amqj.logging.level
</pre><p>
            can be used to configure the logging level.
            For the broker, you can use the environment variable
            AMQJ_LOGGING_LEVEL which is picked up by the qpid-run script
            (called by qpid-server to start the broker) at runtime.
          </p><p>
            For client code that you've written, simply pass in a system
            property to your command line to set it to the level you'd like
            i.e.
          </p><pre class="programlisting">
-Damqj.logging.level=INFO
</pre><p>
            The log level for the broker defaults to INFO if the env variable
            is not set, but you may find that your log4j properties affect
            this. Setting the property noted above should address this.
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="QpidJavaFAQ-HowcanIconfiguremyapplicationtouseQpidclientlogging-3F"></a>1.2.1.9. 
            How can I configure my application to use Qpid client
            logging?
          </h4></div></div></div><p>
            If you don't already have a logging implementation in your
            classpath you should add slf4-log4j12-1.4.0.jar and
            log4j-1.2.12.jar.
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="QpidJavaFAQ-HowcanIconfigurethebroker-3F"></a>1.2.1.10. 
            How can I
            configure the broker ?
          </h4></div></div></div><p>
            The broker configuration is contained in the
            &lt;installed-dir&gt;/etc/config.xml file. You can copy and edit
            this file and then specify your own configuration file as a
            parameter to the startup script using the -c flag i.e.
            qpid-server -c &lt;your_config_file's_path&gt;
          </p><p>
            For more detailed information on configuration, please see
            <a class="xref" href="">???</a>
          </p><p>
            
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="QpidJavaFAQ-Whatportsdoesthebrokeruse"></a>1.2.1.11. 
            What ports
            does the broker use?
          </h4></div></div></div><p>
            The broker defaults to use port 5672 at startup for AMQP
            traffic.
            If the management interface is enabled it starts on port 8999 by
            default.
          </p><p>
            The JMX management interface actually requires 2 ports to
            operate, the second of which is indicated to the client
            application during connection initiation to the main (default:
            8999) port. Previously this second port has been chosen at random
            during broker startup, however since Qpid 0.5 this has been fixed
            to a port 100 higher than the main port(ie Default:9099) in order
            to ease firewall navigation.
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="QpidJavaFAQ-HowcanIchangetheportthebrokerusesatruntime-3F"></a>1.2.1.12. 
            How
            can I change the port the broker uses at runtime ?
          </h4></div></div></div><p>
            The broker defaults to use port 5672 at startup for AMQP
            traffic.
            The broker also uses port 8999 for the JMX Management interface.
          </p><p>
            To change the AMQP traffic port use the -p flag at startup. To
            change the management port use -m
            i.e. qpid-server -p &lt;port_number_to_use&gt; -m
            &lt;port_number_to_use&gt;
          </p><p>
            Use this to get round any issues on your host server with port
            5672/8999 being in use/unavailable.
          </p><p>
            For additional details on what ports the broker uses see <a class="xref" href="Qpid-Java-FAQ.html#QpidJavaFAQ-Whatportsdoesthebrokeruse" title="1.2.1.11.  What ports does the broker use?">Section 1.2.1.11, “
            What ports
            does the broker use?
          ”</a> FAQ
            entry.
            For more detailed information on configuration, please see
            <a class="xref" href="">???</a>
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="QpidJavaFAQ-WhatcommandlineoptionscanIpassintotheqpidserverscript-3F"></a>1.2.1.13. 
            What command line options can I pass into the qpid-server
            script ?
          </h4></div></div></div><p>
            The following command line options are available:
          </p><p>
            The following options are available:
          </p><div class="table"><a name="id2495272"></a><p class="title"><b>Table 1.1. 
            Command Line Options
          </b></p><div class="table-contents"><table summary="
            Command Line Options
          " border="1"><colgroup><col><col><col></colgroup><tbody><tr><td>
                  Option
                </td><td>
                  Long Option
                </td><td>
                  Description
                </td></tr><tr><td>
                  b
                </td><td>
                  bind
                </td><td>
                  Bind to the specified address overriding any value in the
                  config file
                </td></tr><tr><td>
                  c
                </td><td>
                  config
                </td><td>
                  Use the given configuration file
                </td></tr><tr><td>
                  h
                </td><td>
                  help
                </td><td>
                  Prints list of options
                </td></tr><tr><td>
                  l
                </td><td>
                  logconfig
                </td><td>
                  Use the specified log4j.xml file rather than that in the
                  etc directory
                </td></tr><tr><td>
                  m
                </td><td>
                  mport
                </td><td>
                  Specify port to listen on for the JMX Management. Overrides
                  value in config file
                </td></tr><tr><td>
                  p
                </td><td>
                  port
                </td><td>
                  Specify port to listen on. Overrides value in config file
                </td></tr><tr><td>
                  v
                </td><td>
                  version
                </td><td>
                  Print version information and exit
                </td></tr><tr><td>
                  w
                </td><td>
                  logwatch
                </td><td>
                  Specify interval for checking for logging config changes.
                  Zero means no checking
                </td></tr></tbody></table></div></div><br class="table-break"></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="QpidJavaFAQ-HowdoIauthenticatewiththebroker-3FWhatuserid-26passwordshouldIuse-3F"></a>1.2.1.14. 
            How do I authenticate with the broker ? What user id &amp;
            password should I use ?
          </h4></div></div></div><p>
            You should login as user guest with password guest
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="QpidJavaFAQ-HowdoIcreatequeuesthatwillalwaysbeinstantiatedatbrokerstartup-3F"></a>1.2.1.15. 
            How do I create queues that will always be instantiated at
            broker startup ?
          </h4></div></div></div><p>
            You can configure queues which will be created at broker startup
            by tailoring a copy of the virtualhosts.xml file provided in the
            installed qpid-version/etc directory.
          </p><p>
            So, if you're using a queue called 'devqueue' you can ensure that
            it is created at startup by using an entry something like this:
          </p><pre class="programlisting">
&lt;virtualhosts&gt;
  &lt;default&gt;test&lt;/default&gt;
  &lt;virtualhost&gt;
   &lt;name&gt;test&lt;/name&gt;
   &lt;test&gt;
   &lt;queue&gt;
      &lt;name&gt;devqueue&lt;/name&gt;
      &lt;devqueue&gt;
        &lt;exchange&gt;amq.direct&lt;/exchange&gt;
        &lt;maximumQueueDepth&gt;4235264&lt;/maximumQueueDepth&gt;  &lt;!-- 4Mb --&gt;
        &lt;maximumMessageSize&gt;2117632&lt;/maximumMessageSize&gt; &lt;!-- 2Mb --&gt;
        &lt;maximumMessageAge&gt;600000&lt;/maximumMessageAge&gt;  &lt;!-- 10 mins --&gt;
      &lt;/devqueue&gt;
   &lt;/queue&gt;
   &lt;/test&gt;
  &lt;/virtualhost&gt;
&lt;/virtualhosts&gt;
</pre><p>
            Note that the name (in thie example above the name is 'test')
            element should match the virtualhost that you're using to create
            connections to the broker. This is effectively a namespace used
            to prevent queue name clashes etc. You can also see that we've
            set the 'test' virtual host to be the default for any connections
            which do not specify a virtual host (in the &lt;default&gt; tag).
          </p><p>
            You can amend the config.xml to point at a different
            virtualhosts.xml file by editing the &lt;virtualhosts/&gt;
            element.
          </p><p>
            So, for example, you could tell the broker to use a file in your
            home directory by creating a new config.xml file with the
            following entry:
          </p><p>
            &lt;virtualhosts&gt;/home/myhomedir/virtualhosts.xml&lt;/virtualhosts&gt;
          </p><p>
            You can then pass this amended config.xml into the broker at
            startup using the -c flag i.e.
            qpid-server -c &lt;path&gt;/config.xml
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="QpidJavaFAQ-HowdoIcreatequeuesatruntime-3F"></a>1.2.1.16. 
            How do I
            create queues at runtime?
          </h4></div></div></div><p>
            Queues can be dynamically created at runtime by creating a
            consumer for them. After they have been created and bound (which
            happens automatically when a JMS Consumer is created) a publisher
            can send messages to them.
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="QpidJavaFAQ-HowdoItunethebroker-3F"></a>1.2.1.17. 
            How do I tune
            the broker?
          </h4></div></div></div><p>
            There are a number of tuning options available, please see the
            <a class="xref" href="How-to-Tune-M3-Java-Broker-Performance.html" title="2.8.  How to Tune M3 Java Broker Performance">Section 2.8, “
      How to Tune M3 Java Broker Performance
    ”</a> page for more information.
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="QpidJavaFAQ-Wheredoundeliverablemessagesendup-3F"></a>1.2.1.18. 
            Where do
            undeliverable messages end up ?
          </h4></div></div></div><p>
            At present, messages with an invalid routing key will be returned
            to the sender. If you register an exception listener for your
            publisher (easiest to do by making your publisher implement the
            ExceptionListener interface and coding the onException method)
            you'll see that you end up in onException in this case. You can
            expect to be catching a subclass of
            org.apache.qpid.AMQUndeliveredException.
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="QpidJavaFAQ-CanIconfigurethenameoftheQpidbrokerlogfileatruntime-3F"></a>1.2.1.19. 
            Can I configure the name of the Qpid broker log file at
            runtime ?
          </h4></div></div></div><p>
            If you simply start the Qpid broker using the default
            configuration, then the log file is written to
            $QPID_WORK/log/qpid.log
          </p><p>
            This is not ideal if you want to run several instances from one
            install, or acrhive logs to a shared drive from several hosts.
          </p><p>
            To make life easier, there are two optional ways to configure the
            naming convention used for the broker log.
          </p><div class="section" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="QpidJavaFAQ-Settingaprefixorsuffix"></a>
            Setting a prefix
            or suffix
          </h5></div></div></div><p>
            Users should set the following environment variables before
            running qpid-server:
          </p><p>
            QPID_LOG_PREFIX - will prefix the log file name with the
            specified value e.g. if you set this value to be the name of your
            host (for example) it could look something like host123qpid.log
          </p><p>
            QPID_LOG_SUFFIX - will suffix the file name with the specified
            value e.g. if you set this value to be the name of your
            application (for example) if could look something like
            qpidMyApp.log
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="QpidJavaFAQ-IncludingthePID"></a>
            Including the PID
          </h5></div></div></div><p>
            Setting either of these variables to the special value PID will
            introduce the process id of the java process into the file name
            as a prefix or suffix as specified**
          </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="QpidJavaFAQ-Myclientapplicationappearstohavehung-3F"></a>1.2.1.20. 
            My
            client application appears to have hung?
          </h4></div></div></div><p>
            The client code currently has various timeouts scattered
            throughout the code. These can cause your client to appear like
            it has hung when it is actually waiting for the timeout ot
            compelete. One example is when the broker becomes non-responsive,
            the client code has a hard coded 2 minute timeout that it will
            wait when closing a connection. These timeouts need to be
            consolidated and exposed. see <a class="xref" href="">???</a>
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="QpidJavaFAQ-HowdoIcontacttheQpidteam-3F"></a>1.2.1.21. 
            How do I
            contact the Qpid team ?
          </h4></div></div></div><p>
            For general questions, please subscribe to the
            <a class="ulink" href="mailto:users@qpid.apache.org" target="_top">users@qpid.apache.org</a> mailing list.
          </p><p>
            For development questions, please subscribe to the
            <a class="ulink" href="mailto:dev@qpid.apache.org" target="_top">dev@qpid.apache.org</a> mailing list.
          </p><p>
            More details on these lists are available on our <a class="xref" href="">???</a>
            page.
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="QpidJavaFAQ-HowcanIchangeauser-27spasswordwhilethebrokerisup-3F"></a>1.2.1.22. 
            How can I change a user's password while the broker is up ?
          </h4></div></div></div><p>
            You can do this via the <a class="xref" href="">???</a>. To
            do this simply log in to the management console as an admin user
            (you need to have created an admin account in the
            jmxremote.access file first) and then select the 'UserManagement'
            mbean. Select the user in the table and click the Set Password
            button. Alternatively, update the password file and use the
            management console to reload the file with the button at the
            bottom of the 'UserManagement' view. In both cases, this will
            take effect when the user next logs in i.e. will not cause them
            to be disconnected if they are already connected.
          </p><p>
            For more information on the Management Console please see our
            <a class="xref" href="Qpid-JMX-Management-Console.html#Qpid-JMX-Management-Console-User-Guide" title="3.1.1.5.  Qpid JMX Management Console User Guide">Section 3.1.1.5, “
      Qpid JMX Management Console User Guide
    ”</a>
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="QpidJavaFAQ-HowdoIknowifthereisaconsumerforamessageIamgoingtosend-3F"></a>1.2.1.23. 
            How do I know if there is a consumer for a message I am going
            to send?
          </h4></div></div></div><p>
            Knowing that there is a consumer for a message is quite tricky.
            That said using the qpid.jms.Session#createProducer with
            immediate and mandatory set to true will get you part of the way
            there.
          </p><p>
            If you are publishing to a well known queue then immediate will
            let you know if there is any consumer able to pre-fetch that
            message at the time you send it. If not it will be returned to
            you on your connection listener.
          </p><p>
            If you are sending to a queue that the consumer creates then the
            mandatory flag will let you know if they have not yet created
            that queue.
          </p><p>
            These flags will not be able to tell you if the consuming
            application has received the message and is able to process it.
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="QpidJavaFAQ-HowcanIinspectthecontentsofmyMessageStore-3F"></a>1.2.1.24. 
            How
            can I inspect the contents of my MessageStore?
          </h4></div></div></div><p>
            The management console can be used to interogate an active
            broker and browse the contents of a queue.See the <a class="xref" href="">???</a>
            page for further details.
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="QpidJavaFAQ-Whyaremytransientmessagesbeingsoslow-3F"></a>1.2.1.25. 
            Why are
            my transient messages being so slow?
          </h4></div></div></div><p>
            You should check that you aren't sending persistent messages,
            this is the default. If you want to send transient messages you
            must explicitly set this option when instantiating your
            MessageProducer or on the send() method.
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="QpidJavaFAQ-Whydoesmyproducerfillupthebrokerwithmessages-3F"></a>1.2.1.26. 
            Why
            does my producer fill up the broker with messages?
          </h4></div></div></div><p>
            Switch on producer flow control to prevent temporary spikes in
            message production over-filling the broker.

            Of course, if the long-term rate of message production exceeds
            the rate of message
            consumption then that is an architectural problem that can only
            be temporarily mitigated by producer flow control.
	  </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="QpidJavaFAQ-ThebrokerkeepsthrowinganOutOfMemoryexception-3F"></a>1.2.1.27. 
            The
            broker keeps throwing an OutOfMemory exception?
          </h4></div></div></div><p>
            The broker can no longer store any more messages in memory. This
            is particular evident if you are using the MemoryMessageStore. To
            alleviate this issue you should ensure that your clients are
            consuming all the messages from the broker.
          </p><p>
            You may also want to increase the memory allowance to the broker
            though this will only delay the exception if you are publishing
            messages faster than you are consuming. See <a class="xref" href="">???</a> for
            details of changing the memory settings.
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="QpidJavaFAQ-WhyamIgettingabrokersideexceptionwhenItrytopublishtoaqueueoratopic-3F"></a>1.2.1.28. 
            Why am I getting a broker side exception when I try to
            publish to a queue or a topic ?
          </h4></div></div></div><p>
            If you get a stack trace like this when you try to publish, then
            you may have typo'd the exchange type in your queue or topic
            declaration. Open your virtualhosts.xml and check that the
          </p><pre class="programlisting">
&lt;exchange&gt;amq.direct&lt;/exchange&gt;
</pre><pre class="programlisting">
2009-01-12 15:26:27,957 ERROR [pool-11-thread-2] protocol.AMQMinaProtocolSession (AMQMinaProtocolSession.java:365) - Unexpected exception while processing frame. Closing connection. 
java.lang.NullPointerException 
        at org.apache.qpid.server.security.access.PrincipalPermissions.authorise(PrincipalPermissions.java:398) 
        at org.apache.qpid.server.security.access.plugins.SimpleXML.authorise(SimpleXML.java:302) 
        at org.apache.qpid.server.handler.QueueBindHandler.methodReceived(QueueBindHandler.java:111) 
        at org.apache.qpid.server.handler.ServerMethodDispatcherImpl.dispatchQueueBind(ServerMethodDispatcherImpl.java:498) 
        at org.apache.qpid.framing.amqp_8_0.QueueBindBodyImpl.execute(QueueBindBodyImpl.java:167) 
        at org.apache.qpid.server.state.AMQStateManager.methodReceived(AMQStateManager.java:204) 
        at org.apache.qpid.server.protocol.AMQMinaProtocolSession.methodFrameReceived(AMQMinaProtocolSession.java:295) 
        at org.apache.qpid.framing.AMQMethodBodyImpl.handle(AMQMethodBodyImpl.java:93) 
        at org.apache.qpid.server.protocol.AMQMinaProtocolSession.frameReceived(AMQMinaProtocolSession.java:235) 
        at org.apache.qpid.server.protocol.AMQMinaProtocolSession.dataBlockReceived(AMQMinaProtocolSession.java:191) 
        at org.apache.qpid.server.protocol.AMQPFastProtocolHandler.messageReceived(AMQPFastProtocolHandler.java:244) 
        at org.apache.mina.common.support.AbstractIoFilterChain$TailFilter.messageReceived(AbstractIoFilterChain.java:703) 
        at org.apache.mina.common.support.AbstractIoFilterChain.callNextMessageReceived(AbstractIoFilterChain.java:362) 
        at org.apache.mina.common.support.AbstractIoFilterChain.access$1200(AbstractIoFilterChain.java:54) 
        at org.apache.mina.common.support.AbstractIoFilterChain$EntryImpl$1.messageReceived(AbstractIoFilterChain.java:800) 
        at org.apache.qpid.pool.PoolingFilter.messageReceived(PoolingFilter.java:371) 
        at org.apache.mina.filter.ReferenceCountingIoFilter.messageReceived(ReferenceCountingIoFilter.java:96) 
        at org.apache.mina.common.support.AbstractIoFilterChain.callNextMessageReceived(AbstractIoFilterChain.java:362) 
        at org.apache.mina.common.support.AbstractIoFilterChain.access$1200(AbstractIoFilterChain.java:54) 
        at org.apache.mina.common.support.AbstractIoFilterChain$EntryImpl$1.messageReceived(AbstractIoFilterChain.java:800) 
        at org.apache.mina.filter.codec.support.SimpleProtocolDecoderOutput.flush(SimpleProtocolDecoderOutput.java:60) 
        at org.apache.mina.filter.codec.QpidProtocolCodecFilter.messageReceived(QpidProtocolCodecFilter.java:174) 
        at org.apache.mina.common.support.AbstractIoFilterChain.callNextMessageReceived(AbstractIoFilterChain.java:362) 
        at org.apache.mina.common.support.AbstractIoFilterChain.access$1200(AbstractIoFilterChain.java:54) 
        at org.apache.mina.common.support.AbstractIoFilterChain$EntryImpl$1.messageReceived(AbstractIoFilterChain.java:800) 
        at org.apache.qpid.pool.Event$ReceivedEvent.process(Event.java:86) 
        at org.apache.qpid.pool.Job.processAll(Job.java:110) 
        at org.apache.qpid.pool.Job.run(Job.java:149) 
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:885) 
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:907) 
        at java.lang.Thread.run(Thread.java:619) 
</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="QpidJavaFAQ-WhyistherealotofAnonymousIoServicethreads"></a>1.2.1.29. 
            Why
            is there a lot of AnonymousIoService threads
          </h4></div></div></div><p>
            These threads are part of the thread pool used by Mina to process
            the socket. In the future we may provide tuning guidelines but at
            this point we have seen no performance implications from the
            current configuration. As the threads are part of a pool they
            should remain inactive until required.
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="QpidJavaFAQ--22unabletocertifytheprovidedSSLcertificateusingthecurrentSSLtruststore-22whenconnectingtheManagementConsoletothebroker."></a>1.2.1.30. 
            "unable to certify the provided SSL certificate using the
            current SSL trust store" when connecting the Management Console
            to the broker.
          </h4></div></div></div><p>
            You have not configured the console's SSL trust store properly,
            see <a class="xref" href="">???</a> for
            more details.
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="QpidJavaFAQ-CanauseTCPKEEPALIVEorAMQPheartbeatingtokeepmyconnectionopen-3F"></a>1.2.1.31. 
            Can a use TCP_KEEPALIVE or AMQP heartbeating to keep my
            connection open?
          </h4></div></div></div><p>
            See <a class="xref" href="">???</a>
          </p></div></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="Java-General-User-Guides.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="Java-General-User-Guides.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="Java-Environment-Variables.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 1. General User Guides </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 1.3. 
      Java Environment Variables
    </td></tr></table></div><div class="main_text_area_bottom"></div></div></div></body></html>
